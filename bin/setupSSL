#!/bin/sh

usage()
{
	echo Usage: $0 [-p port] certFile
	exit 1
}

port="443"
while getopts p: o
do
        case "$o" in
                p) port="$OPTARG";;
                [?]) usage;;
        esac
done
shift $(($OPTIND-1))

if [ -z "$1" ]; then usage; fi
cert="$1"
if ! [ -e /certs/$cert.pem ]; then
	echo /certs/$cert.pem does not exist!
	exit 2
fi

echo "
Binding {
       Port = $port
       TLScertFile = /certs/$cert.pem
       MaxRequestSize = 10240
       TimeForRequest = 30
}
" >/etc/hiawatha/conf.d/binding.conf
